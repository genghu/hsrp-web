<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSRP - Human Subject Recruitment Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div id="app">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <h1><i class="fas fa-brain me-2"></i>HSRP</h1>
                </div>
                <div id="nav-menu" class="nav-menu">
                    <a href="#" onclick="showPage('home')"><i class="fas fa-home me-1"></i>Home</a>
                    <a href="#" id="nav-login" onclick="showPage('login')"><i class="fas fa-sign-in-alt me-1"></i>Login</a>
                    <a href="#" id="nav-register" onclick="showPage('register')"><i class="fas fa-user-plus me-1"></i>Register</a>
                    <a href="#" id="nav-dashboard" style="display:none;" onclick="showDashboard()"><i class="fas fa-tachometer-alt me-1"></i>Dashboard</a>
                    <div class="language-switcher" id="language-switcher" style="display:none;">
                        <div class="language-dropdown" id="languageDropdown">
                            <i class="fas fa-globe"></i>
                            <span id="currentLang">EN</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="language-menu" id="languageMenu">
                            <div class="language-option active" data-lang="en">
                                <i class="fas fa-flag-usa"></i>
                                <span>English</span>
                            </div>
                            <div class="language-option" data-lang="zh">
                                <i class="fas fa-flag"></i>
                                <span>中文</span>
                            </div>
                        </div>
                    </div>
                    <a href="#" id="nav-logout" style="display:none;" onclick="logout()"><i class="fas fa-sign-out-alt me-1"></i>Logout</a>
                </div>
            </div>
        </nav>

        <main class="container">
            <!-- Home Page -->
            <div id="page-home" class="page active">
                <div class="hero">
                    <h1>Welcome to HSRP</h1>
                    <p class="subtitle">Human Subject Recruitment Platform</p>
                    <p>Connect researchers with participants for scientific studies</p>
                    <div class="hero-buttons">
                        <button class="glass-button" onclick="showPage('register')"><i class="fas fa-rocket me-2"></i>Get Started</button>
                        <button class="glass-button" onclick="showPage('login')"><i class="fas fa-sign-in-alt me-2"></i>Sign In</button>
                    </div>
                </div>

                <div class="features">
                    <div class="feature">
                        <h3><i class="fas fa-microscope me-2"></i>For Researchers</h3>
                        <p>Create experiments, manage sessions, and recruit participants efficiently</p>
                    </div>
                    <div class="feature">
                        <h3><i class="fas fa-users me-2"></i>For Participants</h3>
                        <p>Browse available studies, sign up for sessions, and contribute to science</p>
                    </div>
                    <div class="feature">
                        <h3><i class="fas fa-shield-alt me-2"></i>Secure & Reliable</h3>
                        <p>Your data is protected with enterprise-grade security</p>
                    </div>
                </div>
            </div>

            <!-- Login Page -->
            <div id="page-login" class="page">
                <div class="auth-container">
                    <h2>Login</h2>
                    <form id="login-form" onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" required>
                        </div>
                        <div class="form-group">
                            <label for="login-password">Password</label>
                            <input type="password" id="login-password" required>
                        </div>
                        <div id="login-error" class="error-message"></div>
                        <button type="submit" class="glass-button" style="width:100%;"><i class="fas fa-sign-in-alt me-2"></i>Login</button>
                    </form>
                    <p class="auth-link">Don't have an account? <a href="#" onclick="showPage('register')">Register</a></p>
                </div>
            </div>

            <!-- Register Page -->
            <div id="page-register" class="page">
                <div class="auth-container">
                    <h2>Register</h2>
                    <form id="register-form" onsubmit="handleRegister(event)">
                        <div class="form-group">
                            <label for="register-firstName">First Name</label>
                            <input type="text" id="register-firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="register-lastName">Last Name</label>
                            <input type="text" id="register-lastName" required>
                        </div>
                        <div class="form-group">
                            <label for="register-email">Email</label>
                            <input type="email" id="register-email" required>
                        </div>
                        <div class="form-group">
                            <label for="register-password">Password</label>
                            <input type="password" id="register-password" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label for="register-role">I am a:</label>
                            <select id="register-role" required>
                                <option value="subject">Participant (Subject)</option>
                                <option value="researcher">Researcher</option>
                            </select>
                        </div>
                        <div id="researcher-fields" style="display:none;">
                            <div class="form-group">
                                <label for="register-institution">Institution</label>
                                <input type="text" id="register-institution">
                            </div>
                            <div class="form-group">
                                <label for="register-department">Department</label>
                                <input type="text" id="register-department">
                            </div>
                        </div>
                        <div id="register-error" class="error-message"></div>
                        <button type="submit" class="glass-button" style="width:100%;"><i class="fas fa-user-plus me-2"></i>Register</button>
                    </form>
                    <p class="auth-link">Already have an account? <a href="#" onclick="showPage('login')">Login</a></p>
                </div>
            </div>

            <!-- Researcher Dashboard -->
            <div id="page-researcher-dashboard" class="page">
                <div class="glass-container">
                    <div class="dashboard-header">
                        <h2><i class="fas fa-tachometer-alt me-2"></i>Researcher Dashboard</h2>
                        <button class="glass-button" onclick="showCreateExperiment()"><i class="fas fa-plus me-2"></i>Create New Experiment</button>
                    </div>
                    <div id="researcher-experiments-container"></div>
                </div>
            </div>

            <!-- Subject Dashboard -->
            <div id="page-subject-dashboard" class="page">
                <div class="glass-container">
                    <h2><i class="fas fa-flask me-2"></i>Available Experiments</h2>
                    <div class="tabs">
                        <button class="tab-button active" onclick="showSubjectTab('available')"><i class="fas fa-list me-1"></i>Available Studies</button>
                        <button class="tab-button" onclick="showSubjectTab('registered')"><i class="fas fa-check-circle me-1"></i>My Registrations</button>
                    </div>
                    <div id="subject-available-container" class="tab-content active"></div>
                    <div id="subject-registered-container" class="tab-content"></div>
                </div>
            </div>

            <!-- Create/Edit Experiment Modal -->
            <div id="experiment-modal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeExperimentModal()">&times;</span>
                    <h2 id="experiment-modal-title">Create Experiment</h2>
                    <form id="experiment-form" onsubmit="handleExperimentSubmit(event)">
                        <div class="form-group">
                            <label for="exp-title">Title</label>
                            <input type="text" id="exp-title" required>
                        </div>
                        <div class="form-group">
                            <label for="exp-description">Description</label>
                            <textarea id="exp-description" rows="4" required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="exp-location">Location</label>
                                <input type="text" id="exp-location" required>
                            </div>
                            <div class="form-group">
                                <label for="exp-duration">Duration (minutes)</label>
                                <input type="number" id="exp-duration" min="1" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="exp-compensation">Compensation</label>
                                <input type="text" id="exp-compensation" required>
                            </div>
                            <div class="form-group">
                                <label for="exp-maxParticipants">Max Participants per Session</label>
                                <input type="number" id="exp-maxParticipants" min="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exp-requirements">Requirements (one per line)</label>
                            <textarea id="exp-requirements" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="exp-status">Status</label>
                            <select id="exp-status">
                                <option value="draft">Draft</option>
                                <option value="open">Open for Recruitment</option>
                                <option value="in_progress">In Progress</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                        <div id="experiment-error" class="error-message"></div>
                        <div class="modal-buttons">
                            <button type="button" class="glass-button" onclick="closeExperimentModal()"><i class="fas fa-times me-2"></i>Cancel</button>
                            <button type="submit" class="glass-button"><i class="fas fa-save me-2"></i>Save</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Session Modal -->
            <div id="session-modal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeSessionModal()">&times;</span>
                    <h2 id="session-modal-title">Add Session</h2>
                    <form id="session-form" onsubmit="handleSessionSubmit(event)">
                        <div class="form-group">
                            <label for="session-startTime">Start Time</label>
                            <input type="datetime-local" id="session-startTime" required>
                        </div>
                        <div class="form-group">
                            <label for="session-endTime">End Time</label>
                            <input type="datetime-local" id="session-endTime" required>
                        </div>
                        <div class="form-group">
                            <label for="session-location">Location</label>
                            <input type="text" id="session-location" required>
                        </div>
                        <div class="form-group">
                            <label for="session-maxParticipants">Max Participants</label>
                            <input type="number" id="session-maxParticipants" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="session-notes">Notes (optional)</label>
                            <textarea id="session-notes" rows="3"></textarea>
                        </div>
                        <div id="session-error" class="error-message"></div>
                        <div class="modal-buttons">
                            <button type="button" class="glass-button" onclick="closeSessionModal()"><i class="fas fa-times me-2"></i>Cancel</button>
                            <button type="submit" class="glass-button"><i class="fas fa-save me-2"></i>Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>

        <!-- Notification -->
        <div id="notification" class="notification">
            <div class="d-flex align-items-center">
                <i class="fas fa-check-circle me-2"></i>
                <span id="notificationText">Operation completed successfully!</span>
            </div>
        </div>

        <!-- Floating Action Button -->
        <button id="floating-button" class="floating-button" style="display:none;" onclick="showCreateExperiment()">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
